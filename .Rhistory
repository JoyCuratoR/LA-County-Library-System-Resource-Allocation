file <- file |>
filter(`1.35 County` == "Los Angeles")
# PART 3: cleaning column names and writing it out as a cleaned csv
colnames(file) <- gsub("[^[:alpha:]]", "", colnames(file))
colnames(file) <- gsub("^[0-9]+", "", colnames(file))
View(file)
# correcting column names
colnames(file) <- gsub("^of", paste0("NumOf"), colnames(file))
colnames(file) <- gsub("June", paste0("June30"), colnames(file))
colnames(file) <- gsub("aof", paste0("NumOf"), colnames(file))
View(file)
colnames(file) <- gsub("bof", paste0("NumOf"), colnames(file))
View(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
write.csv(cleaned, 'data/AllData.csv')
View(file)
library(tidyverse)
library(janitor)
# PART 1: reading in library locations
file <- read_csv("D:/R_Studio/Project_Vault/OP_Library/data/All-DataFY20-21.csv")
# PART 2: subsetting the dataframe for only Los Angeles Library Locations
file <- file |>
filter(`1.35 County` == "Los Angeles")
# PART 2: subsetting the dataframe for only Los Angeles Library Locations
file <- file |>
filter(`1.35 County` == "Los Angeles")
colnames(file) <- substr(colnames(file), 5, nchar(colnames(file)))
View(file)
# correcting column names
colnames(file) <- gsub("#", paste0("Num"), colnames(file))
View(file)
colnames(file) <- gsub("^a", paste0(""), colnames(file))
View(file)
colnames(file) <- gsub("^b", paste0(""), colnames(file))
View(file)
library(tidyverse)
library(janitor)
# PART 1: reading in library locations
file <- read_csv("D:/R_Studio/Project_Vault/OP_Library/data/All-DataFY20-21.csv")
# PART 2: subsetting the dataframe for only Los Angeles Library Locations
file <- file |>
filter(`1.35 County` == "Los Angeles")
colnames(file) <- substr(colnames(file), 5, nchar(colnames(file)))
View(file)
colnames(file) <- gsub("#", paste0("Num"), colnames(file))
colnames(file) <- gsub("^a", paste0(""), colnames(file))
colnames(file) <- gsub("^b", paste0(""), colnames(file))
colnames(file)[1] <- "Location"
View(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
write.csv(cleaned, 'data/AllData.csv')
clean_names(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
View(file)
clean_names(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
View(cleaned)
file <- clean_names(file)
View(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
write.csv(cleaned, 'data/AllData.csv')
View(file)
colnames(file)[102] <- "total_num_of_programs"
colnames(file)[103] <- "total_program_attendence"
View(file)
file <- clean_names(file)
# PART 4: cleaned df as csv file
cleaned <- as.data.frame(file)
write.csv(cleaned, 'data/AllData.csv')
read <- read_csv("D:/R_Studio/Project_Vault/OP_Library/data/All-DataFY20-21.csv")
View(read)
library(tidyverse)
library(janitor)
library(readxl)
library(readxl)
ProgramAttendanceFY20_21 <- read_excel("data/ProgramAttendanceFY20-21.xlsx")
View(ProgramAttendanceFY20_21)
library(readxl)
ProgramsFY20_21 <- read_excel("data/ProgramsFY20-21.xlsx")
View(ProgramsFY20_21)
View(ProgramAttendanceFY20_21)
dim(ProgramAttendanceFY20_21) # counts the number of rows, columns in df
dim(ProgramsFY20_21)
# checking for duplicates
duplicated(ProgramAttendanceFY20_21)
# checking for duplicates
duplicated(ProgramAttendanceFY20_21)|>
sum(duplicated(ProgramAttendanceFY20_21))
duplicated(ProgramsFY20_21)|>
sum(duplicated(ProgramsFY20_21))
# PART 2: subsetting the dataframe for only Los Angeles Library Locations
df_attendence <- ProgramAttendanceFY20_21 |>
filter(`1.35 County` == "Los Angeles")
# PART 1: reading in program data
ProgramsFY20_21 <- read_excel("data/ProgramsFY20-21.xlsx")
ProgramAttendanceFY20_21 <- read_excel("data/ProgramAttendanceFY20-21.xlsx")
# checking for duplicates
duplicated(ProgramAttendanceFY20_21)|>
sum(duplicated(ProgramAttendanceFY20_21))
library(tidyverse)
library(janitor)
library(readxl)
# PART 1: reading in program data
ProgramsFY20_21 <- read_excel("data/ProgramsFY20-21.xlsx")
ProgramAttendanceFY20_21 <- read_excel("data/ProgramAttendanceFY20-21.xlsx")
# checking for duplicates
duplicated(ProgramAttendanceFY20_21)|>
sum(duplicated(ProgramAttendanceFY20_21))
duplicated(ProgramsFY20_21)|>
sum(duplicated(ProgramsFY20_21))
# PART 2: subsetting the dataframe for only Los Angeles Library Locations
df_attendence <- ProgramAttendanceFY20_21 |>
filter(`1.35 County` == "Los Angeles")
View(ProgramAttendanceFY20_21)
View(ProgramsFY20_21)
# PART 2: geocoding to make new 'county' column
geocoded <- geocode(ProgramsFY20_21$Location)
library(ggmap)
install.packages("ggmap")
library(ggmap)
# PART 2: geocoding to make new 'county' column
geocoded <- geocode(ProgramsFY20_21$Location)
library(tidygeocoder)
# PART 2: geocoding to make new 'county' column
geocoded <- geocode(ProgramsFY20_21$Location)
write.csv(ProgramAttendanceFY20_21, "data/PorgramAttendence")
write.csv(ProgramsFY20_21,"data/Programs")
# PART 2; loading in csv files
ProgramAttendanceFY20_21 <- read_csv("data/ProgramAttendence")
# PART 2; loading in csv files
ProgramAttendanceFY20_21 <- read_csv("D:/R_Studio/Project_Vault/OP_Librarydata/ProgramAttendence")
write.csv(ProgramAttendanceFY20_21, "data/ProgramAttendence.csv")
write.csv(ProgramsFY20_21,"data/Programs.csv")
# PART 2; loading in csv files
ProgramAttendanceFY20_21 <- read_csv("D:/R_Studio/Project_Vault/OP_Librarydata/data/ProgramAttendence")
# PART 2; loading in csv files
ProgramAttendanceFY20_21 <- read_csv("D:/R_Studio/Project_Vault/OP_Librarydata/data/ProgramAttendence.csv")
# PART 2; loading in csv files
ProgramAttendence <- read_csv("data/ProgramAttendence.csv")
Programs <- read_csv("data/Programs.csv")
# checking for duplicates
duplicated(ProgramAttendance)|>
sum(duplicated(ProgramAttendance))
dim(ProgramAttendance) # counts the number of rows, columns in df
# PART 2; loading in csv files
ProgramAttendence <- read_csv("data/ProgramAttendence.csv")
Programs <- read_csv("data/Programs.csv")
View(Programs)
dim(Programs)
dim(ProgramAttendence) # counts the number of rows, columns in df
# PART 2: geocoding to make new 'county' column
geocoded <- geocode(Programs$Location)
# PART 2: geocoding to make new 'county' column
geocoded <- geocode(Programs)
# PART 2: geocoding to make new 'county' column
geocoded <- geocode(Programs, address = Programs$Location)
View(ProgramsFY20_21)
View(Programs)
AllData <- read_csv("data/All-DataFY20-21.csv")
# PART 3: merge with All Data to get county locations for each library
merged <- merge(Programs, addresses, by = "Location", all.x = T)
# PART 3: merge with All Data to get county locations for each library
merged <- merge(Programs, AllData, by = "Location", all.x = T)
View(merged)
# PART 3: merge with All Data to get county locations for each library
merged <- Programs |>
left_join(select(AllData, location, county), by = "Location")
# PART 3: merge with All Data to get county locations for each library
merged <- Programs |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
View(merged)
# PART 3: merge with All Data to get county locations for each library
Pro_merged <- Programs |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
Attend_merged <- ProgramAttendence |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
View(Attend_merged)
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
View(Pro_merged)
Pro_merged |>
filter(`1.35 County` == "Los Angeles")
# PART 4: subsetting the dataframe for only Los Angeles Library Locations
LA_programs <- Pro_merged |>
filter(`1.35 County` == "Los Angeles")
df_programs <- ProgramsFY20_21 |>
filter(`1.35 County` == "Los Angeles")
LA_attend <- Attend_merged |>
filter(`1.35 County` == "Los Angeles")
View(LA_attend)
View(LA_programs)
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
# Programs
colnames(LA_programs) <- substr(colnames(LA_programs), 5, nchar(colnames(LA_programs)))
View(LA_programs)
# correcting column names
colnames(LA_programs) <- gsub("#", paste0("Num"), colnames(LA_programs))
colnames(LA_programs) <- gsub("^a", paste0(""), colnames(LA_programs))
colnames(LA_programs) <- gsub("^b", paste0(""), colnames(LA_programs))
View(LA_programs)
colnames(file)[1] <- "location"
colnames(file)[13] <- "total_num_of_programs"
colnames(LA_programs)[1] <- "location"
colnames(LA_programs)[13] <- "total_num_of_programs"
View(LA_programs)
colnames(LA_programs)[1] <- "ID"
colnames(LA_programs)[2] <- "location"
colnames(LA_programs)[13] <- "total_num_of_programs"
View(LA_programs)
LA_programs <- clean_names(LA_programs)
View(LA_programs)
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
# PART 6: cleaned df as csv file
cleaned <- as.data.frame(LA_programs)
write.csv(cleaned, 'data/LA_programs.csv')
# Attendance
colnames(LA_attend)[1] <- "ID"
View(LA_attend)
View(LA_programs)
colnames(LA_attend)[17] <- "County"
View(LA_attend)
LA_attend <- clean_names(LA_attend)
View(LA_attend)
cleaned2 <- as.data.frame(LA_attend)
write.csv(cleaned2, 'data/LA_attend.csv')
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
View(AllData)
AllData |>
Filter(`1.35 County` == "Los Angeles")
AllData |>
filter(`1.35 County` == "Los Angeles")
AllData |>
filter(`1.35 County` == "Los Angeles") |>
count()
View(ProgramAttendence)
Pro_merged
View(Pro_merged)
Pro_merged |>
filter(`1.35 County` == "Los Angeles") |>
count()
AllData |>
filter(`1.35 County` == "Los Angeles")
test <- AllData |>
filter(`1.35 County` == "Los Angeles")
View(test)
test2 <- Pro_merged |>
filter(`1.35 County` == "Los Angeles")
View(test2)
missing <- anti_join(test, test2, by = "Location")
View(missing)
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
# adding the missing row back in
missing_row <- anti_join(test, test2, by = "Location")
test2 <- rbind(test2, missing_row)
View(missing_row)
View(LA_programs)
View(missing_row)
View(Pro_merged)
Programs |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
Programs |>
left_join(select(AllData, Location, `1.35 County`), by = "Location") |>
filter(`1.35 County` == "Los Angeles")
Programs |>
left_join(select(AllData, Location, `1.35 County`), by = "Location") |>
filter(`1.35 County` == "Los Angeles") |>
count()
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
View(missing_row)
View(missing)
missing <- anti_join(test, test2, by = "Location")
# adding the missing row back in for Programs subset
missing <- anti_join(test, test2, by = "Location")
missing <- anti_join(test, test2, by = "Location")
View(ProgramAttendanceFY20_21)
View(ProgramAttendence)
View(Programs)
# Combine the two data frames vertically
df <- bind_cols(missing, LA_programs)
# Select only the columns that are present in LA_programs and in the same order
df <- df %>% select(names(LA_programs))
View(df)
View(AllData)
AllData |>
select(Location) |>
filter(`1.11 City` == "Inglewood")
AllData |>
select(`1.11 City`) |>
filter(`1.11 City` == "Inglewood")
AllData |>
select(`1.11 City`) |>
filter(`1.11 City` == "Inglewood") |>
view()
AllData |>
select(`1.11 City`) |>
filter(`1.11 City` == "Inglewood") |>
count()
View(missing)
AllData |>
select(`1.11 City`) |>
filter(`1.11 City` == "INGLEWOOD") |>
count()
Programs |>
select(`1.11 City`) |>
filter(`1.11 City` == "INGLEWOOD") |>
count()
View(ProgramAttendence)
Programs |>
select(Location) |>
filter(Location == "INGLEWOOD PUBLIC LIBRARY") |>
count()
ProgramAttendence |>
select(Location) |>
filter(Location == "INGLEWOOD PUBLIC LIBRARY") |>
count()
# PART 2: loading in csv files
ProgramAttendence <- read_csv("data/ProgramAttendence.csv")
Programs <- read_csv("data/Programs.csv")
AllData <- read_csv("data/All-DataFY20-21.csv")
AllData |>
select(`1.11 City`) |>
filter(`1.11 City` == "INGLEWOOD") |>
count()
Programs |>
select(Location) |>
filter(Location == "INGLEWOOD PUBLIC LIBRARY") |>
count()
ProgramAttendence |>
select(Location) |>
filter(Location == "INGLEWOOD PUBLIC LIBRARY") |>
count()
load("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
library(tidyverse)
library(janitor)
read <- read_excel("data/LibraryExpendituresFY20-21.xlsx")
library(readxl)
read <- read_excel("data/LibraryExpendituresFY20-21.xlsx")
read2 <- read_excel("data/LibraryIncomeFY20-21.xlsx")
write.csv(read, "data/LibraryExpenses.csv")
write.csv(read2, "data/LibraryIncome.csv")
read <- <- read_excel("data/CirculationFY20-21.xlsx")
read <- read_excel("data/CirculationFY20-21.xlsx")
write.csv(read, "data/Circulation.csv")
circulation <- read_csv("data/Circulation.csv")
View(circulation)
read <- clean_names(read)
View(read)
View(read)
write.csv(read, "data/Circulation.csv")
circulation <- read_csv("data/Circulation.csv")
AllData <- read_csv("data/All-DataFY20-21.csv")
# checking for duplicates
duplicated(circulation)|>
sum(duplicated(circulation))
# joining
circ_merged <- circulation |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
# transforming excel file to csv
read <- read_excel("data/CirculationFY20-21.xlsx")
write.csv(read, "data/Circulation.csv")
# loading in data for merging
circulation <- read_csv("data/Circulation.csv")
AllData <- read_csv("data/All-DataFY20-21.csv")
# checking for duplicates
duplicated(circulation)|>
sum(duplicated(circulation))
# joining
circ_merged <- circulation |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
View(circ_merged)
# subsetting
circ_merged <- circ_merged |>
filter(`1.35 County` == "Los Angeles")
# subsetting
circ_merged <- circ_merged |>
filter(`1.35 County` == "Los Angeles") |>
count()
circ_merged |>
filter(`1.35 County` == "Los Angeles") |>
count()
circ_merged <- circ_merged |>
filter(`1.35 County` == "Los Angeles")
# joining
circ_merged <- circulation |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
View(circ_merged)
circ_merged |>
filter(`1.35 County` == "Los Angeles") |>
count()
# subsetting
circ_merged <- circ_merged |>
filter(`1.35 County` == "Los Angeles")
View(circ_merged)
circ_merged <- clean_names(circ_merged)
View(circ_merged)
colnames(circ_merged)[20] <- "county"
View(circ_merged)
save.image("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Circulation.RData")
load("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
library(tidyverse)
library(janitor)
library(readxl)
# PART 2: loading in csv files
ProgramAttendence <- read_csv("data/ProgramAttendence.csv")
Programs <- read_csv("data/Programs.csv")
AllData <- read_csv("data/All-DataFY20-21.csv")
View(ProgramAttendence)
View(Programs)
# the CSVs for Programs and ProgramAttendence don't have Inglewood
#So the subsets I downloaded from Cal Lib is messy and incomplete
colnames(Programs)
# PART 3: merge with All Data to get county locations for each library
Pro_merged <- Programs |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
Attend_merged <- ProgramAttendence |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
View(Pro_merged)
# PART 4: subsetting the dataframe for only Los Angeles Library Locations
LA_programs <- Pro_merged |>
filter(`1.35 County` == "Los Angeles")
LA_attend <- Attend_merged |>
filter(`1.35 County` == "Los Angeles")
View(LA_programs)
View(AllData)
load("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Program.RData")
View(LA_programs)
# the CSVs for Programs and ProgramAttendence don't have Inglewood
#So the subsets I downloaded from Cal Lib is messy and incomplete
colnames(LA_programs)
View(AllData)
load("D:/R_Studio/Project_Vault/OP_Library/LibraryAllocationAnalysis/Circulation.RData")
View(circ_merged)
Locationchildrens_programs_calculate
# exporting for sql
write.csv(circ_merged, "data/LA_circulation")
# exporting for sql
write.csv(circ_merged, "data/LA_circulation.csv")
library(tidyverse)
library(janitor)
library(readxl)
expense <- read_csv("data/LibraryExpenses.csv")
income <- read_csv("data/LibraryIncome.csv")
expense <- clean_names(expense)
income <- clean_names(income)
View(income)
AllData <- read_csv("data/AllData.csv")
expense <- read_csv("data/LibraryExpenses.csv")
income <- read_csv("data/LibraryIncome.csv")
# merging
Expense_merged <- expense |>
left_join(select(AllData, Location, `1.35 County`), by = "Location")
View(expense)
View(AllData)
# cleaning both datasets
expense <- clean_names(expense)
income <- clean_names(income)
View(expense)
# merging
Expense_merged <- expense |>
left_join(select(AllData, Location, `1.35 County`), by = "location")
Expense_merged <- expense |>
left_join(select(AllData, Location, `1.35 County`), by = "location")
# merging
Expense_merged <- expense |>
left_join(select(AllData, location, `1.35 County`), by = "location")
# merging
Expense_merged <- expense |>
left_join(select(AllData, location, county), by = "location")
Income_merged <- income |>
left_join(select(AllData, location, county), by = "location")
View(Income_merged)
# filtering for only LA
Expense_merged <- Expense_merged |>
filter(county == "Los Angeles")
View(Expense_merged)
Income_merged <- Income_merged |>
filter(county == "Los Angeles")
View(Income_merged)
View(Income_merged)
write.csv(read, "data/LA_Expenses.csv")
write.csv(Expense_merged, "data/LA_Expenses.csv")
write.csv(Income_merged, "data/LA_Income.csv")
library(tidyverse)
library(janitor)
library(readxl)
#
visits <- read_excel("data/VisitsFY20-21.xlsx")
visits <- clean_names(visits)
View(visits)
visits <- visits |>
filter(county == "Los Angeles")
View(visits)
visits$library_visits <- ifesle(visits$library_visits == -1, NA,
visits$library_visits)
visits$library_visits <- ifelse(visits$library_visits == -1, NA,
visits$library_visits)
View(visits)
View(visits)
write.csv(visits, "data/LA_Visits.csv")
View(visits)
visits$hours_open_all <- c(782,	3612,	188,	344,	560,	1634,	456,	0,	78,	94,
175,	383,	4802,	1318,	684,	216, 403,	27280,	4092,
22142,	2459,	168,	670,	6266,	3054,	1102,	748,	1767,
3000,	114,	427,	0,	204,	3168,	517)
View(visits)
write.csv(visits, "data/LA_Visits.csv")
